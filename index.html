<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Token Almas SFT</title>
  <!-- Bootstrap desde CDN -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    #status { min-height: 60px; }
    #cornerImage { position: fixed; bottom: 20px; right: 20px; max-width: 150px; }
  </style>
</head>
<body class="bg-light">
  <div class="container py-5">
    <div class="row justify-content-center">
      <div class="col-md-8 col-lg-6">
        <div class="card shadow">
          <div class="card-body text-center">
            <h1 class="card-title mb-4">Token Almas SFT</h1>
            <img src="imagenes/lorddev.jpg" class="img-fluid rounded mb-4" style="max-height: 200px;">
            
            <button id="connectButton" class="btn btn-primary btn-lg mb-3">
              üîå Conectar Wallet
            </button>
            <button id="claimButton" class="btn btn-success btn-lg mb-3" disabled>
              üéÅ Reclamar Token
            </button>
            
            <div id="status" class="alert alert-info"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Ethers.js desde CDN alternativo -->
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
  
  <!-- Nuestro JavaScript embebido para evitar errores 404 -->
  <script>
    // ... (c√≥digo anterior permanece igual)

// Configuraci√≥n adicional
const TOKEN_ID = 1; // ID de tu token SFT
const TOKEN_AMOUNT = 1; // Cantidad a mintear

// 5. Configurar el bot√≥n de reclamar token
document.addEventListener('DOMContentLoaded', () => {
  // ... (c√≥digo anterior permanece igual)
  
  // A√±adir este listener para el bot√≥n de reclamar
  document.getElementById('claimButton').addEventListener('click', mintToken);
});

// 6. Funci√≥n para mintear tokens
async function mintToken() {
  const claimButton = document.getElementById('claimButton');
  const statusElement = document.getElementById('status');
  
  try {
    console.log("Iniciando minteo de token...");
    claimButton.disabled = true;
    statusElement.innerHTML = `
      <div class="d-flex align-items-center">
        <div class="spinner-border spinner-border-sm me-2" role="status">
          <span class="visually-hidden">Cargando...</span>
        </div>
        <span>Preparando transacci√≥n...</span>
      </div>
    `;
    
    // Obtener el signer actual
    const provider = new ethers.providers.Web3Provider(window.ethereum);
    const signer = provider.getSigner();
    const contract = new ethers.Contract(CONTRACT_ADDRESS, ABI, signer);
    
    // Ejecutar el minteo
    const tx = await contract.mint(
      await signer.getAddress(), // Direcci√≥n del receptor
      TOKEN_ID,                 // ID del token
      TOKEN_AMOUNT,             // Cantidad
      "0x"                      // Datos adicionales (vac√≠o)
    );
    
    statusElement.innerHTML = `
      <div class="text-warning">
        ‚è≥ Transacci√≥n enviada. Esperando confirmaci√≥n...
        <div class="small">TX: ${tx.hash.substring(0, 10)}...</div>
      </div>
    `;
    
    // Esperar confirmaci√≥n
    const receipt = await tx.wait();
    console.log("Transacci√≥n confirmada:", receipt);
    
    // Mostrar √©xito
    statusElement.innerHTML = `
      <div class="text-success">
        ‚úÖ Token reclamado exitosamente!
        <div class="small">
          <a href="https://sepolia.etherscan.io/tx/${tx.hash}" target="_blank">
            Ver en Etherscan
          </a>
        </div>
      </div>
    `;
    
    // Resetear bot√≥n despu√©s de 3 segundos
    setTimeout(() => {
      claimButton.textContent = "üéÅ Token Reclamado";
    }, 3000);
    
  } catch (error) {
    console.error("Error al reclamar token:", error);
    
    let errorMessage = error.message;
    if (error.data?.message) {
      errorMessage = error.data.message;
    }
    
    statusElement.innerHTML = `
      <div class="text-danger">
        ‚ùå Error al reclamar token
        <div class="small">${errorMessage}</div>
      </div>
    `;
    
    claimButton.disabled = false;
  }
}

  </script>
</body>
</html>